This README explains the procedure to be followed to setup wm demo
 application with Xively cloud.


******* Steps *******

1. Open wlan/wm_demo/config.mk file and enable XIVELY_CLOUD.
   Disable all other cloud schemes and then build the application

2. Flash the generated mc200 binary using flashprog

3. Reset the device

4. If the device is not provisioned, do provisioning using either WPS or WEBUI
 or Android / IOS APP

5. After provisioning device will connect to the configured AP. On the console,
 cloud status will be seen as disabled. Enable it using the CLI:
   # psm-set cloud enabled 1

6. Cloud interval is default set to 5 seconds. If you want to change the cloud
 interval use:
   # psm-set cloud interval [time in seconds]


******* Xively Demo Setup *******

1. Use the below CLIs to enter feed_id and api_key (required by the Xively
 cloud) in psm:
   # psm-set cloud feed_id 1999292911
   # psm-set cloud api_key "LnlC5RTkwhT8lsTLgX0WmfNw4GNL3DH7DKEgmo0y8CrskNSk"
 Note that only one device with these credentials can be active at a time

2. Reboot the device by either pressing reset button on the device or using
 below CLI command:
   # pm-reboot

Now the device connects to AP and communicates with the cloud server.


******* Xively UI *******

Xively UI can be accessed through the 'Cloud UI' tab on the device homepage
 You can change the state of the led through this UI and the same will
 be reflected on the device (led indicator)
 Similarly, changing the state of led on device (led indicator) will be reflected
 on Xively UI

Note that, the communication between the xively cloud server and the xively
 cloud UI is with websockets on port 8080. So, for the UI to update correctly,
 make sure that you are connected to a network that does not block traffic on
 port 8080.

With these steps, you are ready to use wm_demo with xively cloud (demo purpose)


******* Communication with the Xively Cloud *******

This is how the communication between the device and the xively cloud is carried
 out:

1. Create Xively Context (api_key and feed_id parameters are used in create context)

2. One time call to do_xively_setup() ->
	i. Generate the activation code:
		It is the hash generated (hex) from hmac sha1 using the product secret and serial number.
		Product secret is the key for HMAC SHA1 while serial number is the data for the same.

	ii. HTTP GET to http://api.xively.com/v2/devices/%s/activate (%s -> activation code)

	iii. If successful, JSON response will be received for the above request.
		Extract api_key and feed_id values from response JSON and store in psm

3. Perform operation (Cloud POST: feed get and feed update) periodically

4. Delete Xively Context


******* Xively Production Setup *******

Follow these steps if you want to add your own product batch or a development
 device on the Xively cloud:

1. Login to https://xively.com

2. The next thing is to perform the pre registration of the device(s)
  a. To add a development device:
	i.  Click on the DEVELOP tab
	ii. Add a device by providing the necessary details
	iii. The feed_id and api_key will be generated that can be used for any
		device (without providing the serial number)
	iv. These need to be stored in psm using following CLIs:
		psm-set cloud feed_id [feed_id_value]
		psm-set cloud api_key [api_key_value]
	v. The device can now communicate with the xively cloud using this
		api_key and feed_id

  b. To add a product batch:
	i. Click on the MANAGE tab
	ii. Add a product batch by providing the necessary details
	iii. Enter the serial numbers of all the devices you want to
		register (manually, via the API or by uploading .csv file)
	iv. The api_key and feed_id are generated for each device
	v. Also, a product secret is generated for that particular product batch
	vi. When a device with that particular serial number and having that
		product secret comes up then it gets activated and feed_id and
		api_key is sent back to it.
	vii. The device can now communicate with the xively cloud using this
		api_key and feed_id


******* Xively Parameters *******

1. Product Secret: Every product batch has the same product secret that is
 generated by the Xively cloud. The same should be updated in the application

2. Serial Number: We use MAC Address of the device(6 bytes)
 Serial Number: The serial number is a unique ID assigned to each device,
 accessible to the activation code running on the device. This ID can be a value
 generated and programmed into the device during the manufacturing process, or it
 can be a device specific identity such as a MAC address or processor serial
 number. At all times, non-consecutive serial numbers should be used so that in
 the unfortunate case where a product secret is discovered, it is difficult to
 guess the serial number of other devices. A serial number can be any arbitrary
 string composed of alphanumeric characters as well as the following characters:
 Plus ( + ) Minus ( - ) Comma ( , ) Underscore ( _ ) and Colon ( : )

Both these parameters are sent as inputs to the xively_cloud_start() function
 and are configurable.

For more details, refer https://xively.com/dev/docs/api/product_management/provisioning/
